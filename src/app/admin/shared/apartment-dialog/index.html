<form class="flex" [formGroup]="form" (ngSubmit)="submit()">

    <div class="flex box">
        <div class="form flex">

            <mat-form-field>
                <mat-label>Тип обява</mat-label>
                <mat-select formControlName="apartmentType">
                    <mat-option *ngFor="let item of apartmentTypes | keyvalue" [value]="item.value.id">
                        {{item.value.name}}
                    </mat-option>
                </mat-select>
            </mat-form-field>

            <mat-form-field>
                <mat-label>Изберте град</mat-label>
                <mat-select formControlName="city">
                    <mat-option *ngFor="let item of cities" [value]="item.name">
                        {{item.name}}
                    </mat-option>
                </mat-select>
                <mat-error *ngIf="form.controls.city.hasError('required')">
                    Полето е задължително !
                </mat-error>
                <mat-error *ngFor="let error of errors.city">
                    {{error}}
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                <input matInput type="text" placeholder="Адрес..." formControlName="address" autocomplete="off">
                <mat-error *ngIf="form.controls.address.hasError('required')">
                    Полето е задължително !
                </mat-error>
                <mat-error *ngIf="form.controls.address.hasError('maxlength')">
                    Максималната дължина е 1000 символа !
                </mat-error>
                <mat-error *ngFor="let error of errors.address">
                    {{error}}
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                <input matInput type="text" placeholder="Етаж..." formControlName="floor" autocomplete="off">
                <mat-error *ngIf="form.controls.floor.hasError('required')">
                    Полето е задължително !
                </mat-error>
                <mat-error *ngIf="form.controls.floor.hasError('maxlength')">
                    Максималната дължина е 255 символа !
                </mat-error>
                <mat-error *ngFor="let error of errors.floor">
                    {{error}}
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                <input matInput type="text" placeholder="Тип на имота ( 3-стаен апартамент )..." formControlName="type"
                    autocomplete="off">
                <mat-error *ngIf="form.controls.type.hasError('required')">
                    Полето е задължително !
                </mat-error>
                <mat-error *ngIf="form.controls.type.hasError('maxlength')">
                    Максималната дължина е 255 символа !
                </mat-error>
                <mat-error *ngFor="let error of errors.type">
                    {{error}}
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                <input matInput type="text" placeholder="Строителство ( тухла )..." formControlName="construction"
                    autocomplete="off">
                <mat-error *ngIf="form.controls.construction.hasError('required')">
                    Полето е задължително !
                </mat-error>
                <mat-error *ngIf="form.controls.construction.hasError('maxlength')">
                    Максималната дължина е 255 символа !
                </mat-error>
                <mat-error *ngFor="let error of errors.construction">
                    {{error}}
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                <input matInput type="number" placeholder="Квадратура ( 150 )..." formControlName="quadrature"
                    autocomplete="off">
                <mat-error *ngIf="form.controls.quadrature.hasError('required')">
                    Полето е задължително !
                </mat-error>
                <mat-error *ngIf="form.controls.quadrature.hasError('maxlength')">
                    Максималната дължина е 255 символа !
                </mat-error>
                <mat-error *ngFor="let error of errors.quadrature">
                    {{error}}
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                <input matInput type="text" placeholder="Година на строителство..." formControlName="year"
                    autocomplete="off">
                <mat-error *ngIf="form.controls.year.hasError('required')">
                    Полето е задължително !
                </mat-error>
                <mat-error *ngIf="form.controls.year.hasError('maxlength')">
                    Максималната дължина е 255 символа !
                </mat-error>
                <mat-error *ngFor="let error of errors.year">
                    {{error}}
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                <mat-label>Валута</mat-label>
                <mat-select formControlName="currency">
                    <mat-option *ngFor="let item of currency | keyvalue" [value]="item.value.id">
                        {{item.value.nameBG }} ( {{item.value.name}} )
                    </mat-option>
                </mat-select>
            </mat-form-field>

            <mat-form-field>
                <input matInput type="text" placeholder="Име на собственик..." formControlName="ownerName"
                    autocomplete="off">
                <mat-error *ngIf="form.controls.ownerName.hasError('required')">
                    Полето е задължително !
                </mat-error>
                <mat-error *ngIf="form.controls.ownerName.hasError('maxlength')">
                    Максималната дължина е 255 символа !
                </mat-error>
                <mat-error *ngFor="let error of errors.ownerName">
                    {{error}}
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                <input matInput type="text" placeholder="Телефон на собственик..." formControlName="ownerPhone"
                    autocomplete="off">
                <mat-error *ngIf="form.controls.ownerPhone.hasError('required')">
                    Полето е задължително !
                </mat-error>
                <mat-error *ngIf="form.controls.ownerPhone.hasError('maxlength')">
                    Максималната дължина е 255 символа !
                </mat-error>
                <mat-error *ngFor="let error of errors.ownerPhone">
                    {{error}}
                </mat-error>
            </mat-form-field>


            <mat-form-field>
                <input matInput type="text" placeholder="Имейл на собственик..." formControlName="ownerEmail"
                    autocomplete="off">
                <mat-error *ngIf="form.controls.ownerEmail.hasError('email')">
                    Невалиден имейл !
                </mat-error>
                <mat-error *ngIf="form.controls.ownerEmail.hasError('required')">
                    Полето е задължително !
                </mat-error>
                <mat-error *ngIf="form.controls.ownerEmail.hasError('maxlength')">
                    Максималната дължина е 255 символа !
                </mat-error>
                <mat-error *ngFor="let error of errors.ownerEmail">
                    {{error}}
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                <input matInput type="number" placeholder="Цена..." formControlName="price" autocomplete="off">
                <mat-error *ngIf="form.controls.price.hasError('required')">
                    Полето е задължително !
                </mat-error>
                <mat-error *ngIf="form.controls.price.hasError('maxlength')">
                    Максималната дължина е 255 символа !
                </mat-error>
                <mat-error *ngFor="let error of errors.price">
                    {{error}}
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                <input matInput type="number" placeholder="Цена за кв/м2 ..." formControlName="m2price"
                    autocomplete="off">
                <mat-error *ngIf="form.controls.m2price.hasError('required')">
                    Полето е задължително !
                </mat-error>
                <mat-error *ngIf="form.controls.m2price.hasError('maxlength')">
                    Максималната дължина е 255 символа !
                </mat-error>
                <mat-error *ngFor="let error of errors.m2price">
                    {{error}}
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                <textarea matInput type="text" placeholder="Описание на имота..." formControlName="description"
                    autocomplete="off" rows="5">
                        </textarea>
                <mat-error *ngIf="form.controls.description.hasError('required')">
                    Полето е задължително !
                </mat-error>
                <mat-error *ngIf="form.controls.description.hasError('maxlength')">
                    Максималната дължина е 4096 символа !
                </mat-error>
                <mat-error *ngFor="let error of errors.description">
                    {{error}}
                </mat-error>
            </mat-form-field>

            <section class="center">
                <mat-checkbox formControlName="act16" labelPosition="before">
                    Притежание на Акт 16 на имота
                </mat-checkbox>
            </section>

        </div>

        <div class="apartment-gallery" [class.uploaded]="photos.length > 0">
            <a matRipple (click)="addPhotos()" class="add-photo" [class.uploaded]="photos.length > 0">
                <img src="/assets/images/upload-gallery.png" alt="upload-gallery">
                <span *ngIf="photos.length == 0">
                    Добавете снимки...
                </span>
            </a>
            <a class="photo" *ngFor="let photo of photos; let i = index" (click)="changeCover(i)">
                <img [src]=" getPhoto(i) | safeURL" [class.cover]="i == cover"  alt="photo"/>
                <a class="delete" mat-icon-button (click)="deletePhoto(i)">
                    <i class="flaticon-close"></i>
                </a>
            </a>
        </div>

    </div>

    <button mat-raised-button color="primary" [disabled]="isSubmit">
        {{edit ? 'Коригирай' : 'Добави'}}
    </button>
</form>

<a class="close" mat-icon-button (click)="close()">
    <i class="flaticon-close"></i>
</a>